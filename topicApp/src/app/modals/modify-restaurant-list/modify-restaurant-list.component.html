<ion-header translucent>
  <ion-toolbar>
    <ion-buttons slot="end">
      <ion-button fill="clear" color="primary" (click)="dismissModal()">Close</ion-button>
    </ion-buttons>
    <ion-title>
      <ion-icon name="create-outline"></ion-icon>
      Modify Restaurant List: "{{restaurantsList.name}}"
    </ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>

  <ion-card>
    <form class="wrapform" [formGroup]="modifyRestaurantListForm" (ngSubmit)="submitForm()" novalidate>
      <!--     NAME-->
      <ion-item>
        <ion-icon name="newspaper-outline"></ion-icon>
        <ion-label>List Name</ion-label>
      </ion-item>
      <ion-item>
        <ion-input formControlName="restaurantslistname" type="text" name="restaurantslistname" [(ngModel)]="restaurantsList.name"></ion-input>
      </ion-item>

      <!--      COLLABORATORS-->
      <ion-list>
        <ion-item>
          <ion-icon name="people-circle-outline"></ion-icon>
          <ion-label>Collaborators</ion-label>
        </ion-item>
        <!-- For the sake of simplicity now, we will add users with default permission parameters:
     isCollab = false and isReadOnly = true
     and then we can change the properties within the list using the toggle switch
     -->
        <ion-item *ngIf="isOwner">
          <ion-select formControlName="addedcollaborators" placeholder="Add user(s)..." [multiple]="true" #userSelect>
            <ion-select-option *ngFor="let user of existingDatabaseUsers" value="{{user.username}}">{{user.username}}</ion-select-option>
          </ion-select>
          <ion-button fill="clear" color="primary" (click)="addCollaborators(userSelect.value)"><ion-icon name="person-add-outline"></ion-icon>ADD</ion-button>
        </ion-item>
        <ion-item *ngFor="let existingCollaborator of restaurantsListCollaborators">
          <ion-grid>
            <ion-row>
              <ion-col>
                <ion-label>{{existingCollaborator.username}}</ion-label>
              </ion-col>
              <ion-col *ngIf="isOwner">
                <ion-toggle
                  [checked]="existingCollaborator.isCollab"
                  (ionChange)="updateRole(existingCollaborator)"
                ></ion-toggle>
              </ion-col>
              <ion-col>
                <ion-label *ngIf="existingCollaborator.isCollab">Collaborator</ion-label>
                <ion-label *ngIf="existingCollaborator.isReadOnly">Reader</ion-label>
              </ion-col>
              <ion-col *ngIf="isOwner">
                <ion-button fill="clear" color="primary" (click)="removeCollaborator(existingCollaborator)"><ion-icon name="trash-outline"></ion-icon></ion-button>
              </ion-col>
            </ion-row>
          </ion-grid>
        </ion-item>
        <ion-item>
          <ion-icon name="fast-food-outline"></ion-icon>
          <ion-label>Restaurants</ion-label>
        </ion-item>
        <ion-item>
          <ion-select formControlName="addedrestaurants" placeholder="Add Restaurant(s)" [multiple]="true" #restaurantSelect>
            <ion-select-option *ngFor="let restaurant of existingDatabaseRestaurantsList" value="{{restaurant.restaurantName}}">{{restaurant.restaurantName}}</ion-select-option>
          </ion-select>
          <ion-button fill="clear" color="primary" (click)="addRestaurants(restaurantSelect.value)">ADD</ion-button>
        </ion-item>
        <ion-list *ngFor="let restaurant of restaurants">
          <ion-item>
            <ion-thumbnail class="ion-margin-end thumbnail">
              <ion-img src="{{restaurant.thumbnailURL}}"/>
            </ion-thumbnail>
            <ion-label>
              <ion-grid>
                <ion-row>
                  <ion-col>
                    <h1>
                      <ion-icon name="restaurant-outline"></ion-icon>
                      {{restaurant.restaurantName}}
                    </h1>
                  </ion-col>

                  <ion-col>
                    <ion-button fill="clear" color="primary" (click)="removeRestaurant(restaurant.restaurantName)"><ion-icon name="trash-outline"></ion-icon></ion-button>
                  </ion-col>
                </ion-row>

              </ion-grid>

              <h4>
                <ion-icon name="star-half-outline"></ion-icon>
                Ranking: {{restaurant.ranking}}/5
              </h4>
              <h4>
                <ion-icon name="earth-outline"></ion-icon>
                Cuisine: {{restaurant.cuisine}}
              </h4>
              <p>
                <ion-icon name="pin-outline"></ion-icon>
                {{restaurant.address}}
              </p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-list>

      <div class="buttons">
        <ion-button class="submit-button" fill="outline" shape="round" type="submit">Modify</ion-button>
      </div>
    </form>
  </ion-card>
</ion-content>


